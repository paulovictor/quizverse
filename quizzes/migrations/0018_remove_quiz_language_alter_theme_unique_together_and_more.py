# Generated by Django 5.2.7 on 2025-10-15 00:34

from django.db import migrations, models


def copy_language_to_country(apps, schema_editor):
    """Copia dados de language para country"""
    Theme = apps.get_model('quizzes', 'Theme')
    Quiz = apps.get_model('quizzes', 'Quiz')
    
    # Copiar language para country nos temas
    for theme in Theme.objects.all():
        theme.country = theme.language
        theme.save()
    
    # Copiar language para country nos quizzes
    for quiz in Quiz.objects.all():
        quiz.country = quiz.language
        quiz.save()


class Migration(migrations.Migration):

    dependencies = [
        ('quizzes', '0017_alter_theme_slug_alter_theme_unique_together'),
    ]

    operations = [
        # 1. Adicionar campo country aos modelos
        migrations.AddField(
            model_name='theme',
            name='country',
            field=models.CharField(choices=[('en-US', 'ğŸ‡ºğŸ‡¸ United States'), ('en-CA', 'ğŸ‡¨ğŸ‡¦ Canada'), ('es-MX', 'ğŸ‡²ğŸ‡½ Mexico'), ('en-GB', 'ğŸ‡¬ğŸ‡§ United Kingdom'), ('de-DE', 'ğŸ‡©ğŸ‡ª Germany'), ('fr-FR', 'ğŸ‡«ğŸ‡· France'), ('es-ES', 'ğŸ‡ªğŸ‡¸ Spain'), ('it-IT', 'ğŸ‡®ğŸ‡¹ Italy'), ('nl-NL', 'ğŸ‡³ğŸ‡± Netherlands'), ('sv-SE', 'ğŸ‡¸ğŸ‡ª Sweden'), ('no-NO', 'ğŸ‡³ğŸ‡´ Norway'), ('pl-PL', 'ğŸ‡µğŸ‡± Poland'), ('pt-PT', 'ğŸ‡µğŸ‡¹ Portugal'), ('en-IN', 'ğŸ‡®ğŸ‡³ India'), ('en-PH', 'ğŸ‡µğŸ‡­ Philippines'), ('id-ID', 'ğŸ‡®ğŸ‡© Indonesia'), ('ja-JP', 'ğŸ‡¯ğŸ‡µ Japan'), ('ko-KR', 'ğŸ‡°ğŸ‡· South Korea'), ('th-TH', 'ğŸ‡¹ğŸ‡­ Thailand'), ('vi-VN', 'ğŸ‡»ğŸ‡³ Vietnam'), ('en-AU', 'ğŸ‡¦ğŸ‡º Australia'), ('en-NZ', 'ğŸ‡³ğŸ‡¿ New Zealand'), ('pt-BR', 'ğŸ‡§ğŸ‡· Brazil'), ('es-AR', 'ğŸ‡¦ğŸ‡· Argentina'), ('es-CO', 'ğŸ‡¨ğŸ‡´ Colombia')], default='pt-BR', help_text='PaÃ­s do tema', max_length=10),
        ),
        migrations.AddField(
            model_name='quiz',
            name='country',
            field=models.CharField(choices=[('en-US', 'ğŸ‡ºğŸ‡¸ United States'), ('en-CA', 'ğŸ‡¨ğŸ‡¦ Canada'), ('es-MX', 'ğŸ‡²ğŸ‡½ Mexico'), ('en-GB', 'ğŸ‡¬ğŸ‡§ United Kingdom'), ('de-DE', 'ğŸ‡©ğŸ‡ª Germany'), ('fr-FR', 'ğŸ‡«ğŸ‡· France'), ('es-ES', 'ğŸ‡ªğŸ‡¸ Spain'), ('it-IT', 'ğŸ‡®ğŸ‡¹ Italy'), ('nl-NL', 'ğŸ‡³ğŸ‡± Netherlands'), ('sv-SE', 'ğŸ‡¸ğŸ‡ª Sweden'), ('no-NO', 'ğŸ‡³ğŸ‡ª Norway'), ('pl-PL', 'ğŸ‡µğŸ‡± Poland'), ('pt-PT', 'ğŸ‡µğŸ‡¹ Portugal'), ('en-IN', 'ğŸ‡®ğŸ‡³ India'), ('en-PH', 'ğŸ‡µğŸ‡­ Philippines'), ('id-ID', 'ğŸ‡®ğŸ‡© Indonesia'), ('ja-JP', 'ğŸ‡¯ğŸ‡µ Japan'), ('ko-KR', 'ğŸ‡°ğŸ‡· South Korea'), ('th-TH', 'ğŸ‡¹ğŸ‡­ Thailand'), ('vi-VN', 'ğŸ‡»ğŸ‡³ Vietnam'), ('en-AU', 'ğŸ‡¦ğŸ‡º Australia'), ('en-NZ', 'ğŸ‡³ğŸ‡¿ New Zealand'), ('pt-BR', 'ğŸ‡§ğŸ‡· Brazil'), ('es-AR', 'ğŸ‡¦ğŸ‡· Argentina'), ('es-CO', 'ğŸ‡¨ğŸ‡´ Colombia')], default='pt-BR', help_text='PaÃ­s do quiz', max_length=10),
        ),
        
        # 2. Copiar dados de language para country
        migrations.RunPython(copy_language_to_country, reverse_code=migrations.RunPython.noop),
        
        # 3. Remover unique_together antigo
        migrations.AlterUniqueTogether(
            name='theme',
            unique_together=set(),
        ),
        
        # 4. Remover campo language
        migrations.RemoveField(
            model_name='theme',
            name='language',
        ),
        migrations.RemoveField(
            model_name='quiz',
            name='language',
        ),
        
        # 5. Adicionar novo unique_together
        migrations.AlterUniqueTogether(
            name='theme',
            unique_together={('slug', 'country')},
        ),
    ]
